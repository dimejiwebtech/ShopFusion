{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="py-8 bg-gray-50">
<div class="max-w-7xl mx-auto px-4">

	<nav class="flex mb-4 text-sm" aria-label="Breadcrumb">
		<ol class="inline-flex items-center space-x-1 md:space-x-3">
			<li class="inline-flex items-center">
				<a href="{% url 'store' %}" class="text-gray-700 hover:text-blue-600 inline-flex items-center">
					Shop
				</a>
			</li>
			<li>
				<div class="flex items-center">
					<i class="fa fa-chevron-right text-gray-400 mx-2"></i>
					<span class="text-gray-500">Checkout</span>
				</div>
			</li>
		</ol>
	</nav>

	<!-- Page Header -->
	<div class="mb-6">
		<h1 class="text-3xl font-bold text-gray-900">Checkout</h1>
		<p class="text-gray-600 mt-1">Complete your order</p>
	</div>

	<!-- Checkout Content -->
	<div class="flex flex-wrap lg:flex-nowrap gap-6">
		
		<!-- Billing Information Form -->
		<section class="w-full lg:w-2/3">
			<div class="bg-white shadow-sm rounded-lg p-6">
				<h2 class="font-bold text-2xl text-gray-800 mb-6">Billing Information</h2>

				<form action="" method="POST">
					{% csrf_token %}
					
					<!-- Name Fields -->
					<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
						<div>
							<label class="block text-sm font-semibold text-gray-700 mb-2">
								First Name <span class="text-red-500">*</span>
							</label>
							<input 
								type="text" 
								name="first_name" 
								class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition" 
								placeholder="John"
								required
							>
						</div>
						<div>
							<label class="block text-sm font-semibold text-gray-700 mb-2">
								Last Name <span class="text-red-500">*</span>
							</label>
							<input 
								type="text" 
								name="last_name" 
								class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition" 
								placeholder="Doe"
								required
							>
						</div>
					</div>

					<!-- Contact Fields -->
					<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
						<div>
							<label class="block text-sm font-semibold text-gray-700 mb-2">
								Email Address <span class="text-red-500">*</span>
							</label>
							<input 
								type="email" 
								name="email" 
								class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition" 
								placeholder="john@example.com"
								required
							>
						</div>
						<div>
							<label class="block text-sm font-semibold text-gray-700 mb-2">
								Phone Number <span class="text-red-500">*</span>
							</label>
							<input 
								type="tel" 
								name="phone_number" 
								class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition" 
								placeholder="+1 (555) 000-0000"
								required
							>
						</div>
					</div>

					<!-- Address Fields -->
					<div class="mb-4">
						<label class="block text-sm font-semibold text-gray-700 mb-2">
							Address Line 1 <span class="text-red-500">*</span>
						</label>
						<input 
							type="text" 
							name="address_line_1" 
							class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition" 
							placeholder="Street address, P.O. box"
							required
						>
					</div>

					<div class="mb-4">
						<label class="block text-sm font-semibold text-gray-700 mb-2">
							Address Line 2
						</label>
						<input 
							type="text" 
							name="address_line_2" 
							class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition" 
							placeholder="Apartment, suite, unit (optional)"
						>
					</div>

					<!-- City, State, Country -->
					<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
						<div>
							<label class="block text-sm font-semibold text-gray-700 mb-2">
								City <span class="text-red-500">*</span>
							</label>
							<input 
								type="text" 
								name="city" 
								class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition" 
								placeholder="New York"
								required
							>
						</div>
						<div>
							<label class="block text-sm font-semibold text-gray-700 mb-2">
								State <span class="text-red-500">*</span>
							</label>
							<input 
								type="text" 
								name="state" 
								class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition" 
								placeholder="NY"
								required
							>
						</div>
						<div>
							<label class="block text-sm font-semibold text-gray-700 mb-2">
								Country <span class="text-red-500">*</span>
							</label>
							<input 
								type="text" 
								name="country" 
								class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition" 
								placeholder="United States"
								required
							>
						</div>
					</div>

					<!-- Order Note -->
					<div class="mb-4">
						<label class="block text-sm font-semibold text-gray-700 mb-2">
							Order Note <span class="text-red-500">*</span>
						</label>
						<textarea 
							name="order_note" 
							rows="4" 
							class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 transition resize-none" 
							placeholder="Additional notes about your order (delivery instructions, etc.)"
							required
						></textarea>
					</div>

					<!-- Action Buttons -->
					<div class="flex flex-col sm:flex-row items-center justify-center gap-3 mt-6">
						<button 
							type="submit" 
							class="px-8 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition shadow-sm hover:shadow-md"
						>
							<i class="fa fa-lock mr-2"></i> Place Order
						</button>
						
						<a 
							href="{% url 'store' %}" 
							class="px-8 py-3 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200 transition"
						>
							<i class="fa fa-arrow-left mr-2"></i> Continue Shopping
						</a>
					</div>
				
			</div>
		</section>
		
		<!-- Order Summary -->
		<aside class="w-full lg:w-1/3">
			<div class="bg-white shadow-sm rounded-lg sticky top-24">
				<div class="p-6">
					<h2 class="font-bold text-xl text-gray-800 mb-4">Order Summary</h2>
					
					<div class="space-y-3 mb-4 max-h-96 overflow-y-auto">
						{% for item in cart_items %}
						<div class="flex items-center gap-3 pb-3 border-b border-gray-100">
							<div class="flex-shrink-0 w-16 h-16 bg-gray-100 rounded-lg overflow-hidden">
								<img src="{{ item.product.product_image.url }}" alt="{{ item.product.product_name }}" class="w-full h-full object-cover">
							</div>
							<div class="flex-1 min-w-0">
								<p class="font-semibold text-sm text-gray-900 truncate">{{ item.product.product_name }}</p>
								<p class="text-xs text-gray-500">Qty: {{ item.quantity }}</p>
								{% if item.variations.all %}
									<p class="text-xs text-gray-500">
										{% for i in item.variations.all %}
											{{i.variation_value | capfirst }}{% if not forloop.last %}, {% endif %}
										{% endfor %}
									</p>
								{% endif %}
							</div>
							<div class="text-right">
								<p class="font-bold text-gray-900">${{ item.sub_total }}</p>
							</div>
						</div>
						{% endfor %}
					</div>
					
					<div class="space-y-2 pt-4 border-t border-gray-200">
						<div class="flex justify-between text-gray-600">
							<span>Subtotal:</span>
							<span class="font-semibold">${{ total }}</span>
						</div>
						<div class="flex justify-between text-gray-600">
							<span>Tax:</span>
							<span class="font-semibold">${{ tax }}</span>
						</div>
						<div class="flex justify-between text-lg font-bold text-gray-900 pt-2 border-t border-gray-200">
							<span>Total:</span>
							<span>${{ grand_total }}</span>
						</div>
					</div>
                    </form>
					
					<div class="mt-4 p-3 bg-green-50 rounded-lg">
						<p class="text-xs text-green-800 text-center">
							<i class="fa fa-shipping-fast mr-1"></i> Free shipping on orders over $50
						</p>
					</div>
				</div>
			</div>
		</aside>
	</div>
</div>
</section>
{% endblock %}